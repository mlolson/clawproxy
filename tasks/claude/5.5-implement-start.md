# Task 5.5: Implement `clawproxy start`

**Assignee:** Claude
**Dependencies:** 4.5, 5.1
**Status:** Open

## Description

Implement the command to start the proxy server.

## Acceptance Criteria

- [ ] Load config and validate
- [ ] Load all required secrets
- [ ] Start proxy server
- [ ] Handle graceful shutdown
- [ ] Print startup info

## Implementation

```rust
async fn cmd_start(config_path: Option<PathBuf>) -> Result<()> {
    let config = Config::load(config_path.as_deref())?;

    // Validate config
    config.validate()?;

    // Load secrets
    let secrets_dir = config.secrets_dir();
    if !secrets_dir.exists() {
        anyhow::bail!(
            "Secrets directory not found: {}\nRun 'clawproxy init' first",
            secrets_dir.display()
        );
    }

    let secrets = config::load_all_secrets(&secrets_dir, &config)?;

    // Check all required secrets are present
    for (service_name, service) in &config.services {
        if !secrets.contains_key(&service.secret) {
            anyhow::bail!(
                "Secret '{}' not found (required by service '{}')\n\
                 Run: clawproxy secret set {}",
                service.secret, service_name, service.secret
            );
        }
    }

    tracing::info!(
        host = %config.listen.host,
        port = %config.listen.port,
        services = ?config.services.keys().collect::<Vec<_>>(),
        "Starting proxy server"
    );

    println!("ClawProxy listening on {}:{}", config.listen.host, config.listen.port);
    println!("Services: {}", config.services.keys()
        .map(|s| s.as_str())
        .collect::<Vec<_>>()
        .join(", "));
    println!();
    println!("Press Ctrl+C to stop");

    let server = proxy::ProxyServer::new(config, secrets);
    server.run().await?;

    tracing::info!("Proxy server stopped");
    Ok(())
}
```

## CLI Definition

```rust
#[derive(Subcommand)]
enum Commands {
    Start {
        #[arg(short, long)]
        config: Option<PathBuf>,
    },
    // ...
}
```

## Startup Checks

1. Config file exists and is valid YAML
2. Secrets directory exists with correct permissions
3. All required secrets are present
4. Port is available

## Notes

- Consider PID file for status checks
- Log to file when running as daemon
- Consider `--foreground` flag for explicit foreground mode
